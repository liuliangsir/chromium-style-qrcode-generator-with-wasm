(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();let i;const P=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&P.decode();let p=null;function y(){return(p===null||p.byteLength===0)&&(p=new Uint8Array(i.memory.buffer)),p}function S(t,e){return t=t>>>0,P.decode(y().subarray(t,t+e))}let w=0;const N=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},V=typeof N.encodeInto=="function"?function(t,e){return N.encodeInto(t,e)}:function(t,e){const n=N.encode(t);return e.set(n),{read:t.length,written:n.length}};function z(t,e,n){if(n===void 0){const a=N.encode(t),f=e(a.length,1)>>>0;return y().subarray(f,f+a.length).set(a),w=a.length,f}let r=t.length,o=e(r,1)>>>0;const s=y();let c=0;for(;c<r;c++){const a=t.charCodeAt(c);if(a>127)break;s[o+c]=a}if(c!==r){c!==0&&(t=t.slice(c)),o=n(o,r,r=c+t.length*3,1)>>>0;const a=y().subarray(o+c,o+r),f=V(t,a);c+=f.written,o=n(o,r,c,1)>>>0}return w=c,o}let _=null;function q(){return(_===null||_.buffer.detached===!0||_.buffer.detached===void 0&&_.buffer!==i.memory.buffer)&&(_=new DataView(i.memory.buffer)),_}function Y(t,e){return t=t>>>0,y().subarray(t/1,t/1+e)}function X(t,e){const n=e(t.length*1,1)>>>0;return y().set(t,n/1),w=t.length,n}function $(t){const e=i.__wbindgen_export_3.get(t);return i.__externref_table_dealloc(t),e}function Z(t){const e=z(t,i.__wbindgen_malloc,i.__wbindgen_realloc),n=w,r=i.generate_qr_code_wasm(e,n);if(r[2])throw $(r[1]);return U.__wrap(r[0])}const D=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>i.__wbg_qrcoderesult_free(t>>>0,1));class U{static __wrap(e){e=e>>>0;const n=Object.create(U.prototype);return n.__wbg_ptr=e,D.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();i.__wbg_qrcoderesult_free(e,0)}get data(){const e=i.__wbg_get_qrcoderesult_data(this.__wbg_ptr);var n=Y(e[0],e[1]).slice();return i.__wbindgen_free(e[0],e[1]*1,1),n}set data(e){const n=X(e,i.__wbindgen_malloc),r=w;i.__wbg_set_qrcoderesult_data(this.__wbg_ptr,n,r)}get size(){return i.__wbg_get_qrcoderesult_size(this.__wbg_ptr)>>>0}set size(e){i.__wbg_set_qrcoderesult_size(this.__wbg_ptr,e)}}async function J(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function ee(){const t={};return t.wbg={},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(S(e,n))}finally{i.__wbindgen_free(r,o,1)}},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,o=z(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;q().setInt32(e+4*1,s,!0),q().setInt32(e+4*0,o,!0)},t.wbg.__wbindgen_init_externref_table=function(){const e=i.__wbindgen_export_3,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t.wbg.__wbindgen_string_new=function(e,n){return S(e,n)},t.wbg.__wbindgen_throw=function(e,n){throw new Error(S(e,n))},t}function te(t,e){return i=t.exports,H.__wbindgen_wasm_module=e,_=null,p=null,i.__wbindgen_start(),i}async function H(t){if(i!==void 0)return i;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/qrcode-generator-with-wasm/assets/qrcode_generator_with_wasm_bg-BguyjTHY.wasm",import.meta.url));const e=ee();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await J(await t,e);return te(n,r)}const R=document.getElementById("urlInput"),d=document.getElementById("qrCanvas"),W=document.getElementById("centerErrorLabel"),v=document.getElementById("bottomErrorLabel"),h=document.getElementById("copyButton"),Q=document.getElementById("downloadButton"),l=d.getContext("2d"),j="#000000",m="#FFFFFF",M=20,K=22,k=8,ne=14,oe=3,re=[0,31,224,0,63,240,0,55,240,0,63,240,0,63,240,0,63,240,0,62,0,0,63,192],ie=[128,124,0,129,252,0,195,255,0,231,253,0,255,252,0,255,252,0,127,248,0,63,248,0,31,240,0,15,224,0,7,96,0,6,32,0,4,32,0,6,48,0];let O=null,E=0;const A={INPUT_TOO_LONG:"Input is too long. Please shorten the text.",UNKNOWN_ERROR:"Could not generate QR code. Please try again."};function F(t){I(!1),d.style.display="block",t==="INPUT_TOO_LONG"?(W.style.display="none",v.textContent=A.INPUT_TOO_LONG,v.style.display="block",l.fillStyle=m,l.fillRect(0,0,d.width,d.height)):(v.style.display="none",d.style.display="none",W.textContent=A.UNKNOWN_ERROR,W.style.display="flex")}function I(t){W.style.display="none",v.style.display="none",d.style.display="block",h.disabled=!t,Q.disabled=!t}function se(t,e,n,r,o){const s=r/M,c=o/K;t.fillStyle=j;const a=(f,x,T)=>{for(let g=0;g<x;g++){let L=g*oe,u=128;for(let b=0;b<M;b++){if((f[L]&u)!==0){const C=e+b*s,G=n+(g+T)*c;t.fillRect(Math.floor(C),Math.floor(G),Math.ceil(s),Math.ceil(c))}u>>=1,u===0&&(u=128,L++)}}};a(re,k,0),a(ie,ne,k)}function ce(t,e){if(!t||e===0){l.fillStyle=m,l.fillRect(0,0,d.width,d.height),I(!1),O=null,E=0;return}O=t,E=e;const n=d.width,r=n/e;l.fillStyle=m,l.fillRect(0,0,n,n),l.fillStyle=j;for(let u=0;u<e;u++)for(let b=0;b<e;b++){const C=u*e+b;t[C]===1&&l.fillRect(Math.floor(b*r),Math.floor(u*r),Math.ceil(r),Math.ceil(r))}const o=n*.22,s=o*(M/K),c=(n-s)/2,a=(n-o)/2,f=1.1,x=s*f,T=o*f,g=(n-x)/2,L=(n-T)/2;l.fillStyle=m,l.fillRect(g,L,x,T),se(l,c,a,s,o),I(!0)}async function B(){const t=R.value.trim();if(!t){l.fillStyle=m,l.fillRect(0,0,d.width,d.height),I(!1);return}try{const e=Z(t);if(!e||!e.data){F("UNKNOWN_ERROR"),O=null,E=0;return}ce(e.data,e.size)}catch(e){console.error("Wasm QR generation failed:",e),e&&e.toString().includes("too long")?F("INPUT_TOO_LONG"):F("UNKNOWN_ERROR"),O=null,E=0}}function ae(){R.value&&navigator.clipboard.writeText(R.value).then(()=>{console.log("Text copied to clipboard");const t=h.textContent;h.textContent="Copied!",setTimeout(()=>{h.textContent=t},1500)}).catch(t=>{console.error("Failed to copy text: ",t)})}function le(t){try{const e=new URL(t);if(e.hostname&&!/^\d{1,3}(\.\d{1,3}){3}$/.test(e.hostname))return`qrcode_${e.hostname.replace(/[^a-zA-Z0-9.-]/g,"_")}.png`}catch{}return"qrcode_chrome.png"}function de(){if(!O||E===0)return;const t=le(R.value),e=document.createElement("a");e.download=t,e.href=d.toDataURL("image/png"),e.click()}async function fe(){await H(),console.log("Wasm module initialized."),R.addEventListener("input",B),h.addEventListener("click",ae),Q.addEventListener("click",de),B()}fe();
