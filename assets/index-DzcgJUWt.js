(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();let l;const z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&z.decode();let B=null;function v(){return(B===null||B.byteLength===0)&&(B=new Uint8Array(l.memory.buffer)),B}function Q(t,e){return t=t>>>0,z.decode(v().subarray(t,t+e))}let M=0;const q=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},dt=typeof q.encodeInto=="function"?function(t,e){return q.encodeInto(t,e)}:function(t,e){const n=q.encode(t);return e.set(n),{read:t.length,written:n.length}};function tt(t,e,n){if(n===void 0){const s=q.encode(t),a=e(s.length,1)>>>0;return v().subarray(a,a+s.length).set(s),M=s.length,a}let r=t.length,o=e(r,1)>>>0;const i=v();let c=0;for(;c<r;c++){const s=t.charCodeAt(c);if(s>127)break;i[o+c]=s}if(c!==r){c!==0&&(t=t.slice(c)),o=n(o,r,r=c+t.length*3,1)>>>0;const s=v().subarray(o+c,o+r),a=dt(t,s);c+=a.written,o=n(o,r,c,1)>>>0}return M=c,o}let T=null;function P(){return(T===null||T.buffer.detached===!0||T.buffer.detached===void 0&&T.buffer!==l.memory.buffer)&&(T=new DataView(l.memory.buffer)),T}function ft(t,e){return t=t>>>0,v().subarray(t/1,t/1+e)}function ut(t,e){const n=e(t.length*1,1)>>>0;return v().set(t,n/1),M=t.length,n}function bt(t){const e=l.__wbindgen_export_3.get(t);return l.__externref_table_dealloc(t),e}function _t(t,e,n,r,o){const i=tt(t,l.__wbindgen_malloc,l.__wbindgen_realloc),c=M,s=l.generate_qr_code_with_options(i,c,e,n,r,o);if(s[2])throw bt(s[1]);return j.__wrap(s[0])}const gt=Object.freeze({NoCenterImage:0,0:"NoCenterImage",Dino:1,1:"Dino"}),ht=Object.freeze({Square:0,0:"Square",Rounded:1,1:"Rounded"}),wt=Object.freeze({Squares:0,0:"Squares",Circles:1,1:"Circles"}),yt=Object.freeze({Included:0,0:"Included",WillBeAddedByClient:1,1:"WillBeAddedByClient"}),K=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>l.__wbg_qrcoderesult_free(t>>>0,1));class j{static __wrap(e){e=e>>>0;const n=Object.create(j.prototype);return n.__wbg_ptr=e,K.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();l.__wbg_qrcoderesult_free(e,0)}get data(){const e=l.__wbg_get_qrcoderesult_data(this.__wbg_ptr);var n=ft(e[0],e[1]).slice();return l.__wbindgen_free(e[0],e[1]*1,1),n}set data(e){const n=ut(e,l.__wbindgen_malloc),r=M;l.__wbg_set_qrcoderesult_data(this.__wbg_ptr,n,r)}get size(){return l.__wbg_get_qrcoderesult_size(this.__wbg_ptr)>>>0}set size(e){l.__wbg_set_qrcoderesult_size(this.__wbg_ptr,e)}get original_size(){return l.__wbg_get_qrcoderesult_original_size(this.__wbg_ptr)>>>0}set original_size(e){l.__wbg_set_qrcoderesult_original_size(this.__wbg_ptr,e)}}async function mt(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function pt(){const t={};return t.wbg={},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(Q(e,n))}finally{l.__wbindgen_free(r,o,1)}},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,o=tt(r,l.__wbindgen_malloc,l.__wbindgen_realloc),i=M;P().setInt32(e+4*1,i,!0),P().setInt32(e+4*0,o,!0)},t.wbg.__wbindgen_init_externref_table=function(){const e=l.__wbindgen_export_3,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t.wbg.__wbindgen_string_new=function(e,n){return Q(e,n)},t.wbg.__wbindgen_throw=function(e,n){throw new Error(Q(e,n))},t}function Rt(t,e){return l=t.exports,et.__wbindgen_wasm_module=e,T=null,B=null,l.__wbindgen_start(),l}async function et(t){if(l!==void 0)return l;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/chromium-style-qrcode-generator-with-wasm/assets/chromium_style_qrcode_generator_with_wasm_bg-HKghsyP4.wasm",import.meta.url));const e=pt();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await mt(await t,e);return Rt(n,r)}const N=document.getElementById("urlInput"),h=document.getElementById("qrCanvas"),S=document.getElementById("centerErrorLabel"),U=document.getElementById("bottomErrorLabel"),O=document.getElementById("copyButton"),nt=document.getElementById("downloadButton"),u=h.getContext("2d"),H="#000000",I="#FFFFFF",D=10,Ct=4,R=7,Y=D*4;CanvasRenderingContext2D.prototype.roundRect||(CanvasRenderingContext2D.prototype.roundRect=function(t,e,n,r,o){return typeof o=="number"?o=[o,o,o,o]:o.length===1?o=[o[0],o[0],o[0],o[0]]:o.length===2&&(o=[o[0],o[1],o[0],o[1]]),this.beginPath(),this.moveTo(t+o[0],e),this.arcTo(t+n,e,t+n,e+r,o[1]),this.arcTo(t+n,e+r,t,e+r,o[2]),this.arcTo(t,e+r,t,e,o[3]),this.arcTo(t,e,t+n,e,o[0]),this.closePath(),this});const Z=20,ot=22,G=8,Et=14,Lt=3,Ot=[0,31,224,0,63,240,0,55,240,0,63,240,0,63,240,0,63,240,0,62,0,0,63,192],It=[128,124,0,129,252,0,195,255,0,231,253,0,255,252,0,255,252,0,127,248,0,63,248,0,31,240,0,15,224,0,7,96,0,6,32,0,4,32,0,6,48,0];let C=null,E=0,W=0;const V={INPUT_TOO_LONG:"Input is too long. Please shorten the text to 2000 characters or less.",UNKNOWN_ERROR:"Could not generate QR code. Please try again."};function k(t){A(!1),h.style.display="block",t==="INPUT_TOO_LONG"?(S.classList.add("hidden"),U.textContent=V.INPUT_TOO_LONG,U.classList.remove("hidden"),u.fillStyle=I,u.fillRect(0,0,h.width,h.height)):(U.classList.add("hidden"),h.style.display="none",S.textContent=V.UNKNOWN_ERROR,S.classList.remove("hidden"))}function A(t){S.classList.add("hidden"),U.classList.add("hidden"),h.style.display="block",O.disabled=!t,nt.disabled=!t}function Tt(t,e,n){if(!t||e===0){u.save(),u.setTransform(1,0,0,1,0,0),u.fillStyle=I,u.fillRect(0,0,h.width,h.height),u.restore(),A(!1),C=null,E=0,W=0;return}C=t,E=e,W=n;const r=240,o=window.devicePixelRatio||1,i=r*o;h.width=i,h.height=i,h.style.width="240px",h.style.height="240px",u.setTransform(o,0,0,o,0,0),u.fillStyle=I,u.fillRect(0,0,r,r);const c=r,s=Math.floor(c/n),a=Math.floor((c-n*s)/2);u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high";const b={color:H},w={color:I},y=e>n,f=y?(e-n)/2:0;for(let d=0;d<e;d++)for(let g=0;g<e;g++){const m=d*e+g;if(t[m]&1){let p,L;if(y){if(p=g-f,L=d-f,p<0||L<0||p>=n||L>=n)continue}else p=g,L=d;if(rt(p,L,n))continue;const F=a+(p+.5)*s,at=a+(L+.5)*s,lt=s/2-1;u.fillStyle=b.color,u.beginPath(),u.arc(F,at,lt,0,2*Math.PI),u.fill()}}it(u,{width:n,height:n},b,w,a,s),ct(u,{width:r,height:r},w,s),A(!0)}function rt(t,e,n){return t<R&&e<R||t>=n-R&&e<R||t<R&&e>=n-R}function it(t,e,n,r,o,i){const a=10*(i/10);function b(w,y){let f=w*i,_=y*i,d=i*R;X(t,o+f,o+_,d,d,a,n.color),f+=i,_+=i,d-=2*i,X(t,o+f,o+_,d,d,a,r.color),f+=i,_+=i,d-=2*i,X(t,o+f,o+_,d,d,a,n.color)}b(0,0),b(e.width-R,0),b(0,e.height-R)}function X(t,e,n,r,o,i,c){t.fillStyle=c,t.beginPath(),t.roundRect(e,n,r,o,i),t.fill()}function ct(t,e,n,r){const i=r/10,c=Math.round(Ct*i),s=c*Z,a=c*ot,b=Math.round(2*i);vt(t,e,s,a,b,n,r)}function vt(t,e,n,r,o,i,c=D){if(e.width/2<n+o||e.height/2<r+o){console.warn("Center image too large for canvas bounds");return}let s=(e.width-n)/2,a=(e.height-r)/2;const b=Math.floor((s-o)/c)*c,w=Math.floor((a-o)/c)*c,y=Math.floor((s+n+o+c-1)/c)*c,f=Math.floor((a+r+o+c-1)/c)*c;t.fillStyle=i.color,t.fillRect(b,w,y-b,f-w);const _=Math.round((b+y)/2-(s+n/2)),d=Math.round((w+f)/2-(a+r/2));s+=_,a+=d,Mt(t,s,a,n,r)}function Mt(t,e,n,r,o){const i=r/Z,c=o/ot;t.fillStyle=H;function s(a,b,w){const y=Lt;for(let f=0;f<b;f++){let _=f*y,d=128;for(let g=0;g<Z;g++){if(a[_]&d){const m=e+g*i,p=n+(w+f)*c;t.fillRect(Math.floor(m),Math.floor(p),Math.ceil(i),Math.ceil(c))}d>>=1,d===0&&(d=128,_++)}}}s(Ot,G,0),s(It,Et,G)}async function $(){const t=N.value.trim();if(!t){u.fillStyle=I,u.fillRect(0,0,h.width,h.height),A(!1);return}if(t.length>2e3){k("INPUT_TOO_LONG"),C=null,E=0;return}try{const n=_t(t,wt.Circles,ht.Rounded,gt.Dino,yt.WillBeAddedByClient);if(!n||!n.data){k("UNKNOWN_ERROR"),C=null,E=0;return}Tt(n.data,n.size,n.original_size)}catch(n){console.error("Wasm QR generation failed:",n),n&&n.toString().includes("too long")?k("INPUT_TOO_LONG"):k("UNKNOWN_ERROR"),C=null,E=0}}function Nt(){if(N.value)if(C&&E>0){const t=document.createElement("canvas"),e=t.getContext("2d"),n=Y,r=W*D+n*2;t.width=r,t.height=r,e.imageSmoothingEnabled=!1,e.imageSmoothingQuality="high",st(e,r,C,E),t.toBlob(o=>{const i=new ClipboardItem({"image/png":o});navigator.clipboard.write([i]).then(()=>{const c=O.textContent;O.textContent="Copied!",setTimeout(()=>{O.textContent=c},1500)}).catch(c=>{console.error("Failed to copy image: ",c),J()})},"image/png")}else J()}function J(){navigator.clipboard.writeText(N.value).then(()=>{const t=O.textContent;O.textContent="Copied!",setTimeout(()=>{O.textContent=t},1500)}).catch(t=>{console.error("Failed to copy text: ",t)})}function Bt(t){try{const e=new URL(t);if(e.hostname&&!/^\d{1,3}(\.\d{1,3}){3}$/.test(e.hostname))return`qrcode_${e.hostname.replace(/[^a-zA-Z0-9.-]/g,"_")}.png`}catch{}return"qrcode_chrome.png"}function Wt(){if(!C||E===0)return;const t=Bt(N.value),e=document.createElement("canvas"),n=e.getContext("2d"),r=Y,o=W*D+r*2;e.width=o,e.height=o,n.fillStyle=I,n.fillRect(0,0,o,o),n.imageSmoothingEnabled=!1,n.imageSmoothingQuality="high",st(n,o,C,E);const i=document.createElement("a");i.download=t,i.href=e.toDataURL("image/png"),i.click()}function st(t,e,n,r){t.fillStyle=I,t.fillRect(0,0,e,e);const o=Y,i=D,c={color:H},s={color:I},a=W,b=r>a,w=b?(r-a)/2:0;for(let f=0;f<r;f++)for(let _=0;_<r;_++){const d=f*r+_;if(n[d]&1){let g,m;if(b){if(g=_-w,m=f-w,g<0||m<0||g>=a||m>=a)continue}else g=_,m=f;if(rt(g,m,a))continue;const L=o+(g+.5)*i,x=o+(m+.5)*i,F=i/2-1;t.fillStyle=c.color,t.beginPath(),t.arc(L,x,F,0,2*Math.PI),t.fill()}}it(t,{width:a,height:a},c,s,o,i),ct(t,{width:e,height:e},s,i)}async function Dt(){await et(),console.log("Wasm module initialized."),N.addEventListener("input",$),O.addEventListener("click",Nt),nt.addEventListener("click",Wt),N.value="https://avg.163.com",$()}Dt();
